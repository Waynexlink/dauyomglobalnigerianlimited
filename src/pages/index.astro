---
import BaseLayout from "@layouts/BaseLayout.astro";
import Hero from "@components/Hero.astro";
import MiniInventory from "@components/MiniInventory.astro";
import FaqMaps from "@components/FaqMaps.astro";

import { getCollection } from "astro:content";
import { getImage } from "astro:assets";
import heroCarImage from "@assets/images/hero-car.jpg"; //

// ✅ Optimize your landing hero image
const optimizedImage = await getImage({
  src: heroCarImage,
  format: "avif",
});

// ✅ Fetch all cars and sort by publish date (newest first)
const allCars = await getCollection("cars");
const sortedCars = allCars.sort((a, b) => {
  const dateA = a.data.publishDate ? new Date(a.data.publishDate).getTime() : 0;
  const dateB = b.data.publishDate ? new Date(b.data.publishDate).getTime() : 0;
  return dateB - dateA;
});

// ✅ Limit to the latest 6 cars
const miniInventoryCars = sortedCars.slice(0, 6);
---

<BaseLayout
  title="Dauyom Motors | High-Performance Cars, Reliable Deals & Expert Auto Service"
  description="Discover premium new and used cars at Dauyom Motors. Explore top brands, transparent pricing, and expert auto care — all designed to get you on the road in style and confidence."
  preloadedImage={optimizedImage}
>
  <Hero heroImageUrl={optimizedImage.src} />
  <MiniInventory cars={miniInventoryCars} />

  <!-- ============================================ -->
  <!--               Car Logos Marquee             -->
  <!-- ============================================ -->
  <section id="logos-572">
    <div class="cs-container">
      <div class="cs-marquee">
        <div class="cs-track">
          <div class="cs-content">
            <img
              class="cs-logo"
              src="/assets/images/logos/toyota.svg"
              alt="Toyota"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/honda.svg"
              alt="Honda"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/nissan.svg"
              alt="Nissan"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/mercedes.svg"
              alt="Mercedes-Benz"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/bmw.svg"
              alt="BMW"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/audi.svg"
              alt="Audi"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/volkswagen.svg"
              alt="Volkswagen"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/hyundai.svg"
              alt="Hyundai"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <!-- Duplicate set for seamless loop -->
            <img
              class="cs-logo"
              src="/assets/images/logos/toyota.svg"
              alt="Toyota"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/honda.svg"
              alt="Honda"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/nissan.svg"
              alt="Nissan"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/mercedes.svg"
              alt="Mercedes-Benz"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/bmw.svg"
              alt="BMW"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/audi.svg"
              alt="Audi"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/volkswagen.svg"
              alt="Volkswagen"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/hyundai.svg"
              alt="Hyundai"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
          </div>
          <div class="cs-content">
            <img
              class="cs-logo"
              src="/assets/images/logos/toyota.svg"
              alt="Toyota"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/honda.svg"
              alt="Honda"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/nissan.svg"
              alt="Nissan"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/mercedes.svg"
              alt="Mercedes-Benz"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/bmw.svg"
              alt="BMW"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/audi.svg"
              alt="Audi"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/volkswagen.svg"
              alt="Volkswagen"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/hyundai.svg"
              alt="Hyundai"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <!-- Duplicate set for seamless loop -->
            <img
              class="cs-logo"
              src="/assets/images/logos/toyota.svg"
              alt="Toyota"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/honda.svg"
              alt="Honda"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/nissan.svg"
              alt="Nissan"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/mercedes.svg"
              alt="Mercedes-Benz"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/bmw.svg"
              alt="BMW"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/audi.svg"
              alt="Audi"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/volkswagen.svg"
              alt="Volkswagen"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
            <img
              class="cs-logo"
              src="/assets/images/logos/hyundai.svg"
              alt="Hyundai"
              width="120"
              height="80"
              loading="lazy"
              decoding="async"
            />
          </div>
        </div>
      </div>
    </div>
  </section>
  <FaqMaps />
</BaseLayout>

<style lang="less">
  /*-- -------------------------- -->
<---           Video            -->
<--- -------------------------- -*/
  /* Mobile - 360px */
  @media only screen and (min-width: 0rem) {
    #video-571 {
      padding: var(--sectionPadding);
      background-color: hsl(129, 22%, 40%);
    }
    #video-571 .cs-container {
      width: 100%;
      max-width: 80rem;
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      /* 48px - 64px */
      gap: clamp(3rem, 6vw, 4rem);
    }
    #video-571 .cs-content {
      text-align: left;
      width: 100%;
      max-width: 69rem;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      /* 20px - 44px */
      gap: clamp(1.25rem, 5vw, 2.75rem);
    }
    #video-571 .cs-video-title {
      /* 31px - 39px */
      font-size: clamp(1.9375rem, 6vw, 2.4375rem);
      font-weight: 900;
      line-height: 1.2em;
      text-align: inherit;
      margin: 0;
      color: #fff;
      position: relative;
    }
    #video-571 .cs-video-wrapper {
      width: 100%;
      /* 418px - 760px */
      height: clamp(26.125rem, 50vw, 47.5rem);
      position: relative;
      overflow: hidden;
      border-radius: 0.5rem;
    }
    #video-571 .cs-video-iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
  }
  /*-- -------------------------- -->
<---        Car Logos         -->
<--- -------------------------- -*/

  /* Mobile - 360px */
  @media only screen and (min-width: 0rem) {
    #logos-572 {
      /* 60px - 130px */
      padding: clamp(3.75rem, 8vw, 8.125rem) 0;
      background-color: var(--secondary);
      overflow: hidden;

      .cs-container {
        width: 100%;
        max-width: 100%;
        margin: auto;
      }

      .cs-marquee {
        position: relative;
        width: 100%;
        height: (120/16rem); // 120px converted to rem
        overflow: hidden;

        // Add pause on hover
        &:hover {
          .cs-track {
            animation-play-state: paused;
          }
        }
      }

      .cs-track {
        position: absolute;
        white-space: nowrap;
        will-change: transform;
        animation: marquee 30s linear infinite;
        top: 50%;
        transform: translateY(-50%);
      }

      .cs-content {
        display: inline-flex;
        align-items: center;
        gap: clamp(3rem, 6vw, 5rem);
        padding-right: clamp(3rem, 6vw, 5rem); // Gap after last logo
      }

      .cs-logo {
        width: auto;
        height: (60/16rem); // 60px converted to rem
        max-height: (80/16rem); // 80px converted to rem
        margin: 0;
        display: block;
        filter: brightness(0) invert(1); // Make logos white
        opacity: 0.8;
        transition: opacity 0.3s ease;
        flex-shrink: 0; // Prevent logos from shrinking

        // Hover effect on individual logos
        &:hover {
          opacity: 1;
          filter: brightness(0) invert(1);
        }
      }
    }
  }

  /* Tablet - 768px */
  @media only screen and (min-width: 48rem) {
    #logos-572 {
      .cs-marquee {
        height: (100/16rem); // Slightly taller on tablet
      }

      .cs-logo {
        height: (70/16rem); // Larger logos on tablet
        max-height: (90/16rem);
      }

      .cs-content {
        gap: clamp(4rem, 8vw, 6rem);
        padding-right: clamp(4rem, 8vw, 6rem);
      }
    }
  }

  /* Desktop - 1024px */
  @media only screen and (min-width: 64rem) {
    #logos-572 {
      .cs-marquee {
        height: (120/16rem); // Full height on desktop
      }

      .cs-logo {
        height: (80/16rem); // Full size logos on desktop
        max-height: (100/16rem);
      }

      .cs-content {
        gap: 5rem;
        padding-right: 5rem;
      }

      .cs-track {
        animation-duration: 35s; // Slightly slower on desktop for better readability
      }
    }
  }

  // Keyframe animation for endless scrolling
  @keyframes marquee {
    from {
      transform: translateY(-50%) translateX(0);
    }
    to {
      transform: translateY(-50%) translateX(-50%);
    }
  }
</style>
